p8105_hw6_mk5149
================
Mungyu Kwok
2025-11-25

# Preparation

Load any necessary libraries for this homework

# Problem 1

## Problem 1 Part 1: Data loading and cleaning

The analysis begins by loading the raw data `homicide-data.csv`. The
data is cleaned according to the problem specifications: creating a
`city_state` variable, creating a binary solved variable indicating
whether the homicide is solved, omitting specified cities (Dallas, TX;
Phoenix, AZ; and Kansas City, MO; Tulsa, AL), limiting to `White` and
`Black` victims, and ensuring `victim_age` is numeric.

``` r
# Load the data
homicides = read_csv("data/homicide-data.csv") 
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
homicides_cleaned = homicides |>
  # Step 1: create city_state variable
  mutate(city_state = paste(city, state, sep = ", "),
         # Step 2: create a binary solved variable: 1 for closed by arrest, 0 for unresoved
         solved = if_else(disposition == "Closed by arrest", 1, 0),
         # Step 3: ensure victim_age is numerice
         victim_age = as.numeric(victim_age)
  ) |>
  # Step 4: omit specified cities
  filter(!city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL")) |>
  # Step 5: limit to white or black victims only
  filter(victim_race %in% c("White", "Black")) |>
  # Step 6: remove rows with missing age
  drop_na(victim_age) |>
  # Step 7: Convert victim_sex to a factor, setting 'Female' as the reference level
  mutate(victim_sex = fct_relevel(victim_sex, "Female"))
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `victim_age = as.numeric(victim_age)`.
    ## Caused by warning:
    ## ! NAs introduced by coercion

``` r
# Check "solved" binary variable
homicides_cleaned |> 
  pull(solved) |> 
  unique()
```

    ## [1] 0 1

``` r
homicides_cleaned |>
  head()
```

    ## # A tibble: 6 × 14
    ##   uid   reported_date victim_last victim_first victim_race victim_age victim_sex
    ##   <chr>         <dbl> <chr>       <chr>        <chr>            <dbl> <fct>     
    ## 1 Alb-…      20100601 SATTERFIELD VIVIANA      White               15 Female    
    ## 2 Alb-…      20100102 MULA        VIVIAN       White               72 Female    
    ## 3 Alb-…      20100126 BOOK        GERALDINE    White               91 Female    
    ## 4 Alb-…      20100130 MARTIN-LEY… GUSTAVO      White               56 Male      
    ## 5 Alb-…      20100308 GRAY        STEFANIA     White               43 Female    
    ## 6 Alb-…      20100323 DAVID       LARRY        White               52 Male      
    ## # ℹ 7 more variables: city <chr>, state <chr>, lat <dbl>, lon <dbl>,
    ## #   disposition <chr>, city_state <chr>, solved <dbl>

## Problem 1 Part 2: Logiestic regression for Baltimore, MD

For the city of Baltimore, MD, use the `glm` function to fit a logistic
regression with resolved vs unresolved as the outcome and victim age,
sex and race as predictors. Save the output of `glm` as an R object;
apply the `broom::tidy` to this object; and obtain the estimate and
confidence interval of the adjusted odds ratio for solving homicides
comparing male victims to female victims keeping all other variables
fixed.

``` r
# Filter data fro Baltimore, MD 
baltimore_df = homicides_cleaned |>
  filter(city_state == "Baltimore, MD")

# Fit the logistic regression model
glm_baltimore = glm(solved ~ victim_age + victim_sex + victim_race, 
                    data = baltimore_df,
                    family = binomial)

# Tidy the results
# Exponentiate to get ORs, extracts the required values
or_baltimore = tidy(glm_baltimore, conf.int = TRUE, exponentiate = TRUE) |>
  filter(term == "victim_sexMale") |>
  select(term, estimate, conf.low, conf.high)

or_baltimore
```

    ## # A tibble: 1 × 4
    ##   term           estimate conf.low conf.high
    ##   <chr>             <dbl>    <dbl>     <dbl>
    ## 1 victim_sexMale    0.426    0.324     0.558

The adjusted odds ratio for solving homicides comparing male victims to
female victims in Baltimore, MD is approximately $\mathbf{0.426}$, with
a $95\%$ confidence interval of $(\mathbf{0.325}, \mathbf{0.558})$. This
indicates that the odds of a homicide being solved for male victims are
significantly lower than for female victims, controlling for age and
race.
